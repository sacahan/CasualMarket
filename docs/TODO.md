# CasualTrader v2.0 待辦事項

## 🔴 緊急 (本週內)

- [ ] **修復快取服務 API 不匹配**
  - 問題: `RateLimitedCacheService.get_cached_or_wait()` 參數錯誤
  - 影響: 目前使用 fallback 機制，快取功能無法完全發揮
  - 估時: 1-2 天

- [ ] **升級 Pydantic 模型**
  - 修復 V1 style `@validator` 警告
  - 升級到 V2 `@field_validator`
  - 估時: 1 天

- [ ] **完善錯誤處理機制**
  - 統一錯誤訊息格式
  - 增強網路錯誤恢復
  - 估時: 2-3 天

## 🟡 重要 (2-4 週內)

### 分析工具擴展

- [ ] **ESG 數據分析工具**
  - 氣候管理、風險管理、供應鏈數據
  - 估時: 3 天

- [ ] **估值指標工具**
  - 本益比、股利殖利率、股價淨值比
  - 估時: 2 天

- [ ] **營收分析工具**
  - 月營收追蹤和成長分析
  - 估時: 2 天

### 市場情報工具

- [ ] **外資動態分析**
  - 外資持股、行業投資流向
  - 估時: 3 天

- [ ] **市場指數工具**
  - 即時指數、分類指數、歷史數據
  - 估時: 3 天

- [ ] **新聞公告系統**
  - 公司重大訊息、證交所公告
  - 估時: 2 天

### 交易工具擴展

- [ ] **每日交易統計**
  - 交易量、價格趨勢分析
  - 估時: 2 天

- [ ] **股利資訊工具**
  - 除權息日程、股利政策
  - 估時: 2 天

- [ ] **ETF 數據工具**
  - ETF 基本資料、定期定額排行
  - 估時: 2 天

## 🟢 一般 (1-2 個月內)

### AI 投資分析整合

- [ ] **股票趨勢分析提示**
  - 技術、基本面、籌碼分析
  - 估時: 3 天

- [ ] **外資投資分析提示**
  - 外資流向分析模板
  - 估時: 2 天

- [ ] **市場熱點監控提示**
  - 新聞、交易活動監控
  - 估時: 2 天

- [ ] **股利投資策略提示**
  - 高殖利率股票篩選
  - 估時: 2 天

- [ ] **投資篩選建議提示**
  - 全方位篩選和風險評估
  - 估時: 3 天

### 進階功能

- [ ] **權證交易數據**
  - 權證基本資料、交易統計
  - 估時: 3 天

- [ ] **融資融券統計**
  - 借貸數據、融資融券分析
  - 估時: 2 天

- [ ] **即時交易統計**
  - 每 5 秒更新交易數據
  - 估時: 3 天

### 品質改善

- [ ] **測試覆蓋率提升**
  - 單元測試、整合測試
  - 估時: 1 週

- [ ] **效能優化**
  - API 快取策略、並行處理
  - 估時: 1 週

- [ ] **文檔完善**
  - API 文檔、使用範例
  - 估時: 3 天

## 📊 進度追蹤

### 已完成 ✅

- [x] 基礎架構設計
- [x] OpenAPI 客戶端整合
- [x] 財務分析工具 (損益表、資產負債表、公司資訊)
- [x] MCP 工具註冊
- [x] 基礎整合測試

### 進行中 🔄

- [ ] 快取服務修復
- [ ] 錯誤處理完善

### 計劃中 📋

- [ ] 分析工具擴展
- [ ] 市場情報工具
- [ ] AI 投資分析整合

---

## 🎯 本月重點目標

1. **穩定性優先** - 修復快取服務和錯誤處理
2. **功能擴展** - 完成 ESG、估值、外資分析工具
3. **測試完善** - 提升測試覆蓋率，確保程式碼品質

## 💡 技術改善建議

1. **快取策略優化**
   - 財務數據使用較長 TTL (1小時)
   - 即時數據使用較短 TTL (30秒)
   - 實現智能快取失效機制

2. **API 調用優化**
   - 實現批量查詢功能
   - 減少重複的行業偵測調用
   - 增加請求去重機制

3. **監控與日誌**
   - 增加 API 調用統計
   - 實現效能監控指標
   - 完善錯誤追蹤機制

---

**更新日期**: 2025-10-02
**總估時**: 約 6-8 週完成所有功能
**目前狀態**: 第一階段完成，第二階段進行中
